def splitList cmp xs pivot =
    lhs := []
    rhs := []

    for x in xs do
        if cmp x pivot < 0 then
            lhs = x : lhs
        else
            rhs = x : rhs

    return Pair lhs rhs

def sort cmp xs =
    if length xs <= 1 then
        return xs

    pivot := head xs
    let Pair lhs rhs = splitList cmp (tail xs) pivot

    return (sort cmp lhs) ++ [pivot] ++ (sort cmp rhs)
