-- Solves Project Euler 14

def collatzLength n :: Int -> Int =
    count := 1

    while n != 1 do
        if even n then
            n /= 2
        else
            n = 3 * n + 1

        count += 1

    return count

best := 1
longest := 0

for n in range 2 1000000 do
    newLength := collatzLength n

    if newLength > longest then
        best = n
        longest = newLength

print best
